import numpy as np
import math

# Tạo ma trận xác suất chuyển
P=np.array([0,1/6,1/6,1/6,1/6,1/6,1/6,0,0,0,0,0,0,
			0,0,1/6,1/6,1/6,1/6,1/6,1/6,0,0,0,0,0,
			0,0,1/6,1/6,1/6,1/6,1/6,1/6,0,0,0,0,0,
			0,0,1/12,2/12,2/12,2/12,2/12,2/12,1/12,0,0,0,0,
			0,0,1/18,2/18,3/18,3/18,3/18,3/18,2/18,1/18,0,0,0,
			0,0,1/24,2/24,3/24,4/24,4/24,4/24,3/24,2/24,1/24,0,0,
			0,0,1/30,2/30,3/30,4/30,5/30,5/30,4/30,3/30,2/30,1/30,0,
			0,0,1/36,2/36,3/36,4/36,5/36,6/36,5/36,4/36,3/36,2/36,1/36,
			0,0,0,1/30,2/30,3/30,4/30,5/30,5/30,4/30,3/30,2/30,1/30,
			0,0,0,0,1/24,2/24,3/24,4/24,4/24,4/24,3/24,2/24,1/24,
			0,0,0,0,0,0,0,0,0,0,1,0,0,
			0,0,0,0,0,0,1/12,2/12,2/12,2/12,2/12,2/12,1/12,
			0,0,0,0,0,0,0,1/6,1/6,1/6,1/6,1/6,1/6])
size=int(math.sqrt(len(P)))
P=P.reshape(size,size)
TTH=-1
# Kiểm tra trạng thái hút
for i in range(0,size):
	if P[i][i]==1:
		TTH=i
		break
# Lập ma trận K
K=np.eye((size))
for r in range(0,size): 
	if(r!=TTH):
		for c in range(0,size):
			if(c!=TTH):
				if(c==r):
					K[r][c]=1-P[r][c]
				else:
					K[r][c]=-P[r][c]
# Tạo ma trận b
B=np.full((size,1),1)
for i in range(0,size):
	if(i==TTH):
		B[i]=0
#Giai hệ pt K*x=B
pi=np.linalg.inv(K).dot(B)

print("Thời điểm chạm trung bình để chạm đến trạng thái "+str(TTH)+" là:")
for i in range(0,size):
	print("k^"+str(TTH)+"_"+str(i)+"=  "+str(pi[i][0]))


#[0,0.5,0,0.5,0,0,0,0,0,1/3,0,1/3,0,1/3,0,0,0,0,0,0.5,0,0,0,0.5,0,0,0,1/3,0,0,0,1/3,0,1/3,0,0,0,1/4,0,1/4,0,1/4,0,1/4,0,0,0,1/3,0,1/3,0,0,0,1/3,0,0,0,0.5,0,0,0,0.5,0,0,0,0,0,1/3,0,1/3,0,1/3,0,0,0,0,0,0,0,0,1]